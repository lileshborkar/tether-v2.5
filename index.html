<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TETHER: Mindful Performance</title>
    <!-- Import Future Tech Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;500;700&display=swap"
        rel="stylesheet">
    <link rel="icon" type="image/png" href="icon-192.png">
    <link rel="apple-touch-icon" href="icon-512.png">
    <link rel="manifest" href="manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#22d3ee">
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <canvas id="bgCanvas" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;"></canvas>

    <div class="glass-panel" id="mainPanel">
        <div id="fsBtn">â›¶</div>
        <div class="panel-settings-btn" id="settingsBtn">âš™</div>

        <div class="brand-header">
            <div class="logo-wrapper">
                <img src="tether_logo.png" alt="TETHER" class="app-logo">
            </div>
        </div>

        <div class="meta">
            Target: <span id="lblTime" style="color:white">5</span> min
            <span style="margin: 0 10px;">|</span>
            Cycles: <span id="lblCount" style="color:white">0</span>
        </div>

        <div class="circle-container" id="clockWrapper">
            <div id="ghostRing" class="ghost-ring"></div>
            <div id="breathTxt" class="breath-label">READY</div>
            <svg viewBox="0 0 240 240">
                <circle class="bg-ring" cx="120" cy="120" r="110"></circle>
                <circle id="progRing" class="progress-ring" cx="120" cy="120" r="110"></circle>
            </svg>
            <div class="time-display-group">
                <div class="time-display" id="clock">00:00:00</div>
                <div id="statusHint" class="status-hint">INITIALIZE SESSION</div>
                <div id="closeTarget" class="status-hint" style="opacity: 0.2; margin-top: 5px;">CLOSE: --:--</div>
            </div>
        </div>

        <div class="grid-controls">
            <div class="section-label">TIMEFRAME SELECT</div>
            <select id="intervalSel">
                <option value="1">1 MIN â€¢ SCALP</option>
                <option value="3">3 MIN â€¢ SCALP</option>
                <option value="5" selected>5 MIN â€¢ INTRADAY</option>
                <option value="15">15 MIN â€¢ INTRADAY</option>
                <option value="30">30 MIN â€¢ SWING</option>
                <option value="60">60 MIN â€¢ H1 HOURLY</option>
                <option value="240">4 HR â€¢ H4 TREND</option>
            </select>
            <div class="viz-container">
                <canvas id="vizCanvas"></canvas>
            </div>

            <div class="main-toggles">
                <div class="main-toggle shield" id="noiseBtn">
                    <span>AMBIENCE</span>
                </div>
                <div class="main-toggle pings" id="pingBtn">
                    <span>PULSE</span>
                </div>
                <div class="main-toggle breath" id="bioBtn">
                    <span>BREATHE</span>
                </div>
            </div>
        </div>

        <!-- SETTINGS HUB -->
        <div id="settingsOverlay" class="overlay">
            <div class="settings-content">

                <div class="tab-bar">
                    <button class="tab-btn active" data-tab="ambient">AMBIENCE</button>
                    <button class="tab-btn" data-tab="notify">PULSE</button>
                    <button class="tab-btn" data-tab="biosync">BREATHE</button>
                    <button class="tab-btn" data-tab="stats">STATS</button>
                    <button class="tab-btn" data-tab="theme">THEME</button>
                    <button class="tab-btn" data-tab="presets">PRESETS</button>
                    <button class="tab-btn" data-tab="help">HELP</button>
                </div>
                <!-- AMBIENCE (Shield Settings) -->
                <div id="ambient-section" class="settings-section active">
                    <div class="grid-controls" style="margin-top:0">
                        <div class="section-label" style="margin-top:0">FOCUS SHIELD: DUAL MIX</div>

                        <div class="main-toggle shield" id="atmBtn" style="grid-column: span 2; margin-bottom: 5px;">
                            <span>ATMOSPHERE SYNCING</span>
                        </div>

                        <!-- Layer 1 -->
                        <div style="font-size: 0.6rem; color: var(--text-muted); opacity: 0.6; margin-bottom: -10px;">
                            LAYER 01</div>
                        <select id="shieldSel" style="margin-top:10px;">
                            <option value="brown">DEEP BROWN NOISE</option>
                            <option value="rain">SOFT RAIN</option>
                            <option value="waves">OCEAN WAVES</option>
                            <option value="binaural">10HZ BINAURAL</option>
                        </select>

                        <div class="vol-control" style="margin-top:0px">
                            <div class="vol-row">
                                <input type="range" id="volNoise" min="0" max="1" step="0.01" value="0.15">
                                <button class="test-btn" id="testShield" title="Test Layer 1">ðŸ”Š</button>
                            </div>
                        </div>

                        <!-- Layer 2 -->
                        <div style="font-size: 0.6rem; color: var(--text-muted); opacity: 0.6; margin-bottom: -10px;">
                            LAYER 02 (MIX)</div>
                        <select id="shieldSel2" style="margin-top:10px;">
                            <option value="none">SILENT</option>
                            <option value="brown">DEEP BROWN NOISE</option>
                            <option value="rain">SOFT RAIN</option>
                            <option value="waves">OCEAN WAVES</option>
                            <option value="binaural">10HZ BINAURAL</option>
                        </select>

                        <div class="vol-control" style="margin-top:0px">
                            <div class="vol-row">
                                <input type="range" id="volNoise2" min="0" max="1" step="0.01" value="0.0">
                                <button class="test-btn" id="testShield2" title="Test Layer 2">ðŸ”Š</button>
                            </div>
                        </div>

                        <button class="return-btn exit-settings" style="margin-top:10px; grid-column: span 2;">RETURN TO
                            TETHER</button>
                    </div>
                </div>

                <!-- PULSE (Precision Pings) -->
                <div id="notify-section" class="settings-section">
                    <div class="grid-controls" style="margin-top:0">
                        <div class="section-label" style="margin-top:0">MINUTE CADENCE</div>
                        <div class="vol-control">
                            <div class="vol-label">INTENSITY <span id="valPing" class="vol-val">20%</span></div>
                            <div class="vol-row">
                                <div class="anchor-toggle" id="pingBtnSet" title="Toggle Pulse">OFF</div>
                                <input type="range" id="volPing" min="0" max="1" step="0.01" value="0.2">
                                <button class="test-btn" id="testPing" title="Test Pulse">ðŸ”Š</button>
                            </div>
                        </div>

                        <div
                            style="font-size: 0.65rem; color: var(--text-muted); margin-bottom: 5px; opacity: 0.7; grid-column: span 2; text-align: center;">
                            5-second countdown for every minute.</div>

                        <div class="section-label" style="margin-top:10px">NOTIFICATION ANCHORS</div>
                        <div class="vol-control">
                            <div class="vol-label">MINUTE CHIME <span id="valMin" class="vol-val">20%</span></div>
                            <div class="vol-row">
                                <div class="anchor-toggle active" id="btnMinChime" title="Toggle Minute Chime">ON</div>
                                <input type="range" id="volMinute" min="0" max="1" step="0.01" value="0.2">
                                <button class="test-btn" id="testMin" title="Test Minute Chime">ðŸ”Š</button>
                            </div>
                        </div>
                        <div class="vol-control">
                            <div class="vol-label">WARNING CHIME <span id="valWarn" class="vol-val">10%</span></div>
                            <div class="vol-row">
                                <div class="anchor-toggle active" id="btnWarnChime" title="Toggle Warning Chime">ON
                                </div>
                                <input type="range" id="volWarn" min="0" max="1" step="0.01" value="0.1">
                                <button class="test-btn" id="testWarn" title="Test Warning Chime">ðŸ”Š</button>
                            </div>
                        </div>
                        <div class="vol-control">
                            <div class="vol-label">FINAL SESSION GONG <span id="valFin" class="vol-val">10%</span></div>
                            <div class="vol-row">
                                <div class="anchor-toggle active" id="btnFinGong" title="Toggle Final Gong">ON</div>
                                <input type="range" id="volFinish" min="0" max="1" step="0.01" value="0.1">
                                <button class="test-btn" id="testFin" title="Test Final Gong">ðŸ”Š</button>
                            </div>
                        </div>

                        <div class="section-label" style="margin-top:10px">HAPTIC FEEDBACK</div>
                        <div class="main-toggle pings" id="hapticBtn"
                            style="grid-column: span 2; margin-top: 5px; margin-bottom: 20px;">
                            <span>HAPTICS: OFF</span>
                        </div>

                        <button class="return-btn exit-settings" style="margin-top:10px; grid-column: span 2;">RETURN TO
                            TETHER</button>
                    </div>
                </div>

                <!-- BREATH SYNC -->
                <div id="biosync-section" class="settings-section">
                    <div class="grid-controls" style="margin-top:0">
                        <div class="section-label" style="margin-top:0">BREATHE</div>
                        <select id="breathSel" style="margin-top:10px;">
                            <option value="box">BOX â€¢ 4-4-4-4 (FOCUS)</option>
                            <option value="relax">RELAX â€¢ 4-7-8 (CALM)</option>
                            <option value="cohere">COHERENCE â€¢ 5.5-5.5 (HRV)</option>
                            <option value="energy">ENERGY â€¢ 4-2 (ALERTS)</option>
                        </select>
                        <button class="return-btn exit-settings" style="margin-top:20px; grid-column: span 2;">RETURN TO
                            TETHER</button>
                    </div>
                </div>

                <!-- STATS -->
                <div id="stats-section" class="settings-section">
                    <div class="grid-controls" style="margin-top:0">
                        <div class="section-label" style="margin-top:0">LIFETIME ANALYTICS</div>
                        <div class="vol-control">
                            <div class="vol-label">TOTAL FOCUS TIME <span id="stMins" class="vol-val"
                                    style="color:#fff">0 MINS</span></div>
                        </div>
                        <div class="vol-control">
                            <div class="vol-label">COMPLETED CYCLES <span id="stCycles" class="vol-val"
                                    style="color:#fff">0</span></div>
                        </div>
                        <div class="vol-control">
                            <div class="vol-label">CURRENT STREAK <span id="stStreak" class="vol-val"
                                    style="color:var(--primary)">0 DAYS</span></div>
                        </div>
                        <button class="return-btn exit-settings" style="margin-top:10px; grid-column: span 2;">RETURN TO
                            TETHER</button>
                    </div>
                </div>

                <!-- PRESETS -->
                <div id="presets-section" class="settings-section">
                    <div class="grid-controls" style="margin-top:0">
                        <div class="section-label" style="margin-top:0">SAVE PRESET</div>

                        <div style="grid-column: span 2; display: flex; gap: 10px; margin-top: 10px;">
                            <input type="text" id="presetName" placeholder="NAME (E.G. DEEP WORK)">
                            <button id="savePresetBtn" class="test-btn"
                                style="width: auto; padding: 0 15px; height: 36px;">SAVE</button>
                        </div>

                        <div class="section-label" style="margin-top:15px">YOUR FLOWS</div>
                        <div id="presetsList"
                            style="grid-column: span 2; display: flex; flex-direction: column; gap: 8px; max-height: 180px; overflow-y: auto; padding-right: 5px;">
                            <!-- Presets dynamically added here -->
                        </div>

                        <button class="return-btn exit-settings" style="margin-top:10px; grid-column: span 2;">RETURN TO
                            TETHER</button>
                    </div>
                </div>

                <!-- THEMES -->
                <div id="theme-section" class="settings-section">
                    <div class="grid-controls" style="margin-top:0">
                        <div class="section-label" style="margin-top:0">VISUAL OVERRIDE</div>
                        <select id="themeSel" style="margin-top:10px;">
                            <option value="cyan">CYAN NEON (DEFAULT)</option>
                            <option value="solar">SOLAR FLARE (GOLD)</option>
                            <option value="void">DEEP SPACE (PURPLE)</option>
                            <option value="moss">BIO-LUM (MINT)</option>
                            <option value="custom">CUSTOM ACCENT</option>
                        </select>

                        <div id="customColorWrap" style="display:none; grid-column: span 2; margin-top: 15px;">
                            <div class="section-label" style="margin-top:0">CHOOSE ACCENT</div>
                            <input type="color" id="primaryColorPicker" value="#22d3ee"
                                style="width: 100%; height: 40px; background: none; border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer; padding: 2px;">
                        </div>

                        <div class="section-label" style="margin-top:15px">BASE SHADE</div>
                        <select id="shadeSel" style="margin-top:10px;">
                            <option value="abyss">DEEP ABYSS (DEFAULT)</option>
                            <option value="black">PITCH BLACK (OLED)</option>
                            <option value="gray">MIDNIGHT GRAY</option>
                            <option value="custom">CUSTOM SHADE</option>
                        </select>

                        <div id="customShadeWrap" style="display:none; grid-column: span 2; margin-top: 15px;">
                            <div class="section-label" style="margin-top:0">CHOOSE BACKGROUND</div>
                            <input type="color" id="bgColorPicker" value="#0f172a"
                                style="width: 100%; height: 40px; background: none; border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer; padding: 2px;">
                        </div>

                        <div
                            style="font-size: 0.65rem; color: var(--text-muted); opacity: 0.7; margin-top: 10px; text-align: center; grid-column: span 2;">
                            Selected theme and shade apply instantly to entire ecosystem.
                        </div>
                        <button class="return-btn exit-settings" style="margin-top:10px; grid-column: span 2;">RETURN TO
                            TETHER</button>
                    </div>
                </div>
                <!-- HELP & MANUAL -->
                <div id="help-section" class="settings-section">
                    <div class="manual-text">
                        <p><strong>CORE COMMANDS:</strong></p>
                        <p><kbd>CLICK CLOCK</kbd> or <kbd>SPACE</kbd> â†’ Flow Toggle</p>
                        <p><kbd>B</kbd> â†’ Toggle Breath Sync</p>
                        <p><kbd>A</kbd> â†’ Toggle Ambience</p>
                        <p><kbd>P</kbd> â†’ Pulse Toggle</p>
                        <p><kbd>F</kbd> â†’ Fullscreen â›¶</p>
                        <p><kbd>S</kbd> â†’ Settings Cog âš™</p>
                        <br>
                        <p><strong>SONIC & VISUAL ANCHORS:</strong></p>
                        <p>â€¢ <strong>Master Start:</strong> Activates all focus elements (Ambience + Breath) on start.
                        </p>
                        <p>â€¢ <strong>Master Terminate:</strong> Stops all active focus elements simultaneously.</p>
                        <p>â€¢ <strong>High Chimes:</strong> Signal each minute.</p>
                        <p>â€¢ <strong>Deep Gong:</strong> Marks session completion.</p>
                        <hr style="opacity:0.1; margin: 15px 0;">
                        <p>Welcome to <strong>TETHER v2.5</strong>. This ecosystem is designed to sync biological
                            rhythms with high-precision work cycles.
                        </p>

                        <p><strong>1. MOBILE INSTALLATION:</strong> TETHER is a high-performance web app. For the best
                            experience, save it to your home screen:</p>
                        <ul style="font-size: 0.65rem; color: var(--text-muted); padding-left: 20px; line-height: 1.6;">
                            <li><strong>iOS:</strong> Tap <span style="color:#fff">Share</span> â†’ <span
                                    style="color:#fff">Add to Home Screen</span>.</li>
                            <li><strong>Android:</strong> Tap <span style="color:#fff">Menu (â‹®)</span> â†’ <span
                                    style="color:#fff">Install App</span> or <span style="color:#fff">Add to Home
                                    Screen</span>.</li>
                        </ul>
                        <p style="font-size: 0.65rem; margin-top:10px;">Compatible mobile devices will also trigger
                            **subtle haptic feedback** during session transitions.</p>

                        <p><strong>2. ANALYTICS (STATS):</strong> Your total focus time and completed cycles are tracked
                            across sessions. View your lifetime progress in the **STATS** tab.</p>

                        <p><strong>3. DUAL-MIX AMBIENCE:</strong> Blend two soundscape layers in the **AMBIENCE** tab.
                            Use **ATMOSPHERE SYNCING** to link the audio volume to your breathing pattern.</p>

                        <p><strong>4. VISUAL PERSONALIZATION:</strong> Fully customize TETHER in the **THEME** tab.
                            Choose a **Custom Accent** for glows and a **Base Shade** (Abyss, OLED, or Gray) to tune
                            your atmosphere.</p>

                        <p><strong>5. FLOW PRESETS:</strong> Capture your current session setupâ€”including mixed audio,
                            visual themes, and background shadesâ€”into a named preset for instant one-click recall.</p>

                        <p
                            style="text-align: center; margin-top: 20px; opacity: 0.5; font-size: 0.7rem; font-family: 'Orbitron', sans-serif; letter-spacing: 2px;">
                            SYSTEM VERSION: TETHER v2.5</p>

                        <!-- Added Install Button -->
                        <button id="installBtn" class="return-btn"
                            style="margin-top:10px; grid-column: span 2; display: none; background: #22c55e; color: #000;">
                            INSTALL TETHER APP
                        </button>

                    </div>
                    <button class="return-btn exit-settings" style="margin-top:20px; width:100%;">RETURN TO
                        TETHER</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Linked Modules -->
    <script src="js/audio.js"></script>
    <script src="js/visuals.js"></script>
    <script src="js/app.js"></script>
</body>

</html>